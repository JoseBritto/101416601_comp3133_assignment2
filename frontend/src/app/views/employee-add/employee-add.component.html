<app-navbar></app-navbar>
<div class="outer">
  <mat-card class="main">
    <h3>New Employee</h3>
    <form [formGroup]="employeeForm" (ngSubmit)="onSubmit()" [class.was-validated]="submitted">

      <!-- Photo Preview -->
      <div class="mb-3">
        <div class="photo-preview">
          <img src="https://ui-avatars.com/api/?name=John+Doe" alt="Profile Preview" class="mat-elevation-z4"  *ngIf="!photoPreview" />
          <img [src]="photoPreview" alt="Profile Preview" class="mat-elevation-z4"  *ngIf="photoPreview" />
        </div>
      </div>

      <!-- Photo -->
      <mat-form-field appearance="fill" class="w-100 mb-3">
        <mat-label>Photo Url (optional)</mat-label>
        <input matInput type="text" formControlName="employee_photo" (input)="updatePreview()" placeholder="https://example.com/photo.jpg" />
      </mat-form-field>

      <!-- First Name -->
      <mat-form-field appearance="fill" class="w-100 mb-3">
        <mat-label>First Name</mat-label>
        <input matInput formControlName="first_name" (input)="updatePreview()" />
        <mat-error *ngIf="employeeForm.get('first_name')?.touched && employeeForm.get('first_name')?.invalid">
          First name is required.
        </mat-error>
      </mat-form-field>

      <!-- Last Name -->
      <mat-form-field appearance="fill" class="w-100 mb-3">
        <mat-label>Last Name</mat-label>
        <input matInput formControlName="last_name" (input)="updatePreview()" />
        <mat-error *ngIf="employeeForm.get('last_name')?.touched && employeeForm.get('last_name')?.invalid">
          Last name is required.
        </mat-error>
      </mat-form-field>

      <!-- Email -->
      <mat-form-field appearance="fill" class="w-100 mb-3">
        <mat-label>Email</mat-label>
        <input matInput type="email" formControlName="email" />
        <mat-error *ngIf="employeeForm.get('email')?.touched && employeeForm.get('email')?.hasError('required')">
          Email is required.
        </mat-error>
        <mat-error *ngIf="employeeForm.get('email')?.touched && employeeForm.get('email')?.hasError('email')">
          Enter a valid email address.
        </mat-error>
      </mat-form-field>

      <!-- Gender -->
      <mat-form-field appearance="fill" class="w-100 mb-3">
        <mat-label>Gender</mat-label>
        <mat-select formControlName="gender">
          <mat-option value="Male">Male</mat-option>
          <mat-option value="Female">Female</mat-option>
          <mat-option value="Other">Other</mat-option>
        </mat-select>
        <mat-error *ngIf="employeeForm.get('gender')?.touched && employeeForm.get('gender')?.invalid">
          Gender is required.
        </mat-error>
      </mat-form-field>

      <!-- Designation -->
      <mat-form-field appearance="fill" class="w-100 mb-3">
        <mat-label>Designation</mat-label>
        <input matInput formControlName="designation" />
        <mat-error *ngIf="employeeForm.get('designation')?.touched && employeeForm.get('designation')?.invalid">
          Designation is required.
        </mat-error>
      </mat-form-field>

      <!-- Department -->
      <mat-form-field appearance="fill" class="w-100 mb-3">
        <mat-label>Department</mat-label>
        <input matInput formControlName="department" />
        <mat-error *ngIf="employeeForm.get('department')?.touched && employeeForm.get('department')?.invalid">
          Department is required.
        </mat-error>
      </mat-form-field>

      <!-- Salary -->
      <mat-form-field appearance="fill" class="w-100 mb-3">
        <mat-label>Salary</mat-label>
        <input matInput type="number" formControlName="salary" />
        <mat-error *ngIf="employeeForm.get('salary')?.touched && employeeForm.get('salary')?.hasError('required')">
          Salary is required.
        </mat-error>
        <mat-error *ngIf="employeeForm.get('salary')?.touched && employeeForm.get('salary')?.hasError('min')">
          Minimum salary is 1000.
        </mat-error>
      </mat-form-field>

      <!-- Date of Joining -->
      <mat-form-field appearance="fill" class="w-100 mb-3">
        <mat-label>Date of Joining</mat-label>
        <input matInput type="date" formControlName="date_of_joining" />
        <mat-error *ngIf="employeeForm.get('date_of_joining')?.touched && employeeForm.get('date_of_joining')?.invalid">
          Date of joining is required.
        </mat-error>
      </mat-form-field>


      <!-- Buttons -->
      <div class="d-flex justify-content-end mt-4">
        <button mat-raised-button color="warn" type="button" class="me-2" (click)="router.navigate(['/employees'])">Cancel</button>
        <button mat-raised-button color="primary" type="submit" [disabled]="employeeForm.invalid">Save</button>
      </div>

    </form>

    <button mat-raised-button class="close" (click)="router.navigate(['/employees'])" aria-label="Close">
      <span>X</span>
    </button>
  </mat-card>
</div>
